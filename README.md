# WARP Driver Board Hardware 

WARP is the dedicated motor driver and power distribution board that powers our Autonomous Underwater Vehicle (AUV). This advanced board translates high-level navigation commands into precise motor controls, while simultaneously organizes an efficient and safe power distribution network. Its built-in monitoring system and safety features provide robust defenses against potential electrical failures, ensuring the AUV can withstand the challenging underwater environment.

<picture>   <img alt="warp" src="Media/warp v23.png"> </picture>


This repository focuses Warp's hardware design. For more details on the firmware, visit the [Warp Firmware Repository](https://github.com/onur-ulusoy/auv-warp-firmware).


<picture>   <img alt="dash" src="Media/logos/dash.png"> </picture>


<p align="center">
    <a href="https://auv.itu.edu.tr/">
        <img width="180" src="Media/logos/auv-electronics.png">
    </a>
</p>


<p align="center"><em >AUV Electronics 2022</em></p>

<picture>   <img alt="dash" src="Media/logos/dash.png"> </picture>


<p align="center">
    <a href="https://auv.itu.edu.tr/">
        <img width="600" src="Media/logos/auv.png">
    </a>
</p>


<picture>   <img alt="dash" src="Media/logos/dash.png"> </picture>

<p align="center">
    <img width="1500" src="Media/logos/logos.png">
</p>

<picture>   <img alt="dash" src="Media/logos/dash.png"> </picture>





## Table of Contents
- [WARP Driver Board Hardware](#warp-driver-board-hardware)
  - [Table of Contents](#table-of-contents)
  - [Board Description](#board-description)
  - [Electronics Design](#electronics-design)
    - [Layer Structure](#layer-structure)
    - [Primary Stage Protection](#primary-stage-protection)
    - [Secondary Stage Protection](#secondary-stage-protection)
    - [Microcontroller](#microcontroller)
  - [Mechanical Architecture](#mechanical-architecture)
  - [Technologies Used](#technologies-used)
  - [Project Timeline](#project-timeline)
  - [LICENSE](#license)

## Board Description

The Warp Driver Board manages the direction movements of the underwater vehicle. It controls the brushless AC motors, connected to the propellers known as Thrusters, with PWM signals via integrated circuits called ESCs, based on commands received from the vehicle's onboard computer NVDIA Jetson Xavier. The commands are transmitted from the computer to the main board, then to the driver board, with the conversion of the UART signal to RS232 signal in the form of protobuf encrypted data.

The secondary, but equally crucial, function of the Warp Driver Board is to manage power distribution. It stabilizes the 14-16 Volt input from the battery and provides steady 12V and 5V outputs to other electronic components, the onboard computer, and various peripherals. The Warp Driver Board also includes a secondary 5V regulator to control the voltage supplied to its onboard microcontroller. 

The board is designed with safety and efficiency in mind. It includes a 100A fuse at the battery input and can measure current/voltage in various areas using integrated ADCs, thereby shutting down the vehicle in case of danger. To accurately measure voltages, it utilizes shunt resistors and voltage dividers. Critical data about current, voltage, and temperatures at key points are displayed on an LCD screen. 


## Electronics Design

<picture>   <img alt="fuse" src="Media/pcb-topview.gif"> </picture>


### Layer Structure

The WARP Driver Board features a meticulously engineered 4-layer Printed Circuit Board (PCB) structure, designed using the advanced capabilities of Altium Designer. At the heart of the layout are the power and ground layers, smartly employed as inter-layers within the design.

These inter-layers serve more than just conducting electricity or acting as a return path. Their positioning within the inner layers of the board provides a close and uniform ground plane across the board, significantly reducing loop inductance for high-speed signals. This layout strategy inherently offers enhanced signal integrity and reduces the susceptibility of the board to electromagnetic interference (EMI), which could otherwise compromise the reliability and performance of the system.

Moreover, by sandwiching the power and ground planes between the outer signal layers, the PCB achieves a better thermal management. Heat generated by components mounted on the outer layers can be efficiently spread across the plane layers and dissipated, ensuring that the board components always remain within safe operating temperatures. This design is particularly critical in a demanding application environment such as an Autonomous Underwater Vehicle, where managing thermal behavior is crucial to maintain overall system reliability and longevity.

The 4-layer structure, thus, adds significant robustness to the WARP Driver Board, enabling it to effectively support complex and power-intensive operations while ensuring optimal performance and safety.

For a more detailed examination of the board layers and the overall PCB structure, you can visit the file [WARP.PcbDoc](/WARP.PcbDoc).

### Primary Stage Protection

The design of the WARP Driver Board integrates a 100A fuse at the start of the power distribution chain, serving as the primary line of defense against overcurrent situations. Overcurrent conditions, potentially caused by short circuits, overloads, or device failures, can result in significant damage to the electronics. The fuse, meticulously calibrated to handle the high power requirements of the Autonomous Underwater Vehicle, disconnects the power supply in an overcurrent event, safeguarding all downstream circuitry and components. This strategic integration of protection measures ensures the AUV's reliability and longevity, even under challenging underwater conditions.

<picture>   <img alt="fuse" src="Media/fuse.png"> </picture>

### Secondary Stage Protection

In addition to the primary fuse protection, the WARP Driver Board also implements a secondary stage of protective measures through its comprehensive sensing system. Critical areas on the board are monitored using advanced instrumentation circuits paired with four Analog-to-Digital Converters (ADCs).

These ADC circuits continuously monitor important parameters such as the ESC and battery voltages, currents, and ESC temperatures. This information provides a real-time overview of the board's operation and the health of its critical components.

In the event that these monitored parameters deviate from their safe operating ranges - such as experiencing overcurrent, overheating, or abnormal voltage conditions - the microcontroller is immediately alerted. Based on the severity of the deviations, the microcontroller can take appropriate actions, including throttling back operations or, in extreme cases, halting operation entirely to prevent damage.

This two-tiered approach to protection, encompassing both hardware (fuse) and software (microcontroller and sensing system) measures, enhances the safety and reliability of the WARP Driver Board. It ensures that the board can withstand a broad range of operational scenarios while minimizing the risk of component damage and system failure.


<picture>   <img alt="fuse" src="Media/adcs.png"> </picture>

### Microcontroller

The WARP Driver Board's heart is an STM32 development board, strategically mounted on the top layer. It utilizes a powerful Cortex series STM32F401 microcontroller, supplying the processing power required for managing the complex tasks associated with an Autonomous Underwater Vehicle.

The microcontroller's firmware is tailored specifically for the STM32F401, enhancing control over the hardware's functionality. It integrates the FreeRTOS, a real-time operating system, enabling efficient task scheduling and management. This feature ensures that critical operations like motor driving and power monitoring are handled both coherently and responsively, thereby boosting the system's overall reliability and performance.

FreeRTOS prioritizes high-importance real-time tasks, such as motor control and power management, allowing them to be addressed immediately. Lower-priority tasks are also effectively managed without compromising system performance. The harmonious combination of this firmware and real-time operating system grants the WARP Driver Board the ability to execute its key tasks with the needed precision, efficiency, and reliability.

For a deeper understanding and more detailed information and source code on the firmware, feel free to visit the [Warp Firmware Repository](https://github.com/onur-ulusoy/auv-warp-firmware).





## Mechanical Architecture


## Technologies Used



## Project Timeline

## LICENSE


